<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Lifting Timer</title>
    <link rel="stylesheet" href="bootstrap.min.css">
  </head>
  <body>
    <h1>Hello, world!</h1>
		<div class="countdown"></div>

		<button type="button" class="btn btn-lg btn-primary" onclick='initTimer()'>Primary</button>
	<script src="jquery-1.12.4.min.js"></script>

	<script>


function initTimer(time) {
var timer2 = "0:05";
var interval = setInterval(function() {

  var timer = timer2.split(':');
  var minutes = parseInt(timer[0], 10);
  var seconds = parseInt(timer[1], 10);
  seconds--;
  minutes = (seconds < 0) ? --minutes : minutes;
  if (minutes < 0) {
	clearInterval(interval);
	$('.countdown').html('0:00');
	sendNotification();
  } else {
  seconds = (seconds < 0) ? 59 : seconds;
  seconds = (seconds < 10) ? '0' + seconds : seconds;

  $('.countdown').html(minutes + ':' + seconds);
  timer2 = minutes + ':' + seconds;
  }
}, 1000);
}

function sendNotification () {
		navigator.serviceWorker.register('sw.js');

        Notification.requestPermission().then( function( permission )
        {
            if ( permission != "granted" )
            {
                alert( "Notification failed!" );
                return;
            }
			options = {
				title: 'Times Up!',
				message: 'Time to lift!',
				icon:'https://cdn.discordapp.com/emojis/356677866005594112.png',
				clickCallback: function () {
					alert('do something when clicked on notification');
				}
			}
            navigator.serviceWorker.ready.then( function( registration )
            {
				console.log('SEND');
                registration.showNotification( options );
            } );


        } );
}


</script>

  </body>
</html>
